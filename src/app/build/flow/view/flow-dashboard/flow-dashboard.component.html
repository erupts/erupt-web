<div class="flow-dashboard">
    <!-- 主要内容区域 -->
    <div class="main-content">
        <!-- 左侧分类导航 -->
        <div class="category-sidebar">
            <div class="category-header">
                <h3>流程分类</h3>
                <button
                    nz-button
                    nzType="text"
                    nzSize="small"
                    (click)="refreshData()"
                    [nzLoading]="loading">
                    <i nz-icon nzType="reload"></i>
                </button>
            </div>
            <div class="category-list">
                <div
                    class="category-item"
                    *ngFor="let category of categories"
                    [class.active]="selectedCategory === category.key"
                    (click)="onCategorySelect(category.key)">
                    <span class="category-name">{{ category.name }}</span>
                    <span class="category-count" *ngIf="category.key">
            ({{ getCategoryFlowCount(category.key) }})
          </span>
                </div>
            </div>
        </div>

        <!-- 右侧流程内容 -->
        <div class="content-area">
            <!-- 搜索框 -->
            <div class="search-container" *ngIf="!loading">
                <nz-input-group nzPrefixIcon="search" nzSize="default">
                    <input
                        type="text"
                        nz-input
                        style="width: 200px"
                        [(ngModel)]="searchKeyword"
                        (ngModelChange)="onSearchChange()"
                        placeholder="搜索流程名称...">
                </nz-input-group>
            </div>

            <!-- 加载状态 -->
            <div class="loading-container" *ngIf="loading">
                <nz-spin nzSize="large">
                    <div class="loading-text">加载中...</div>
                </nz-spin>
            </div>

            <!-- 流程内容 -->
            <div class="flow-groups" *ngIf="!loading">
                <!-- 空状态 -->
                <div class="empty-state" *ngIf="filteredFlowGroups.length === 0">
                    <i nz-icon nzType="inbox" nzTheme="outline"></i>
                    <p *ngIf="!searchKeyword">暂无流程数据</p>
                    <p *ngIf="searchKeyword">未找到匹配的流程</p>
                    <button nz-button nzType="primary" (click)="refreshData()" *ngIf="!searchKeyword">
                        刷新数据
                    </button>
                    <button nz-button nzType="default" (click)="searchKeyword = ''; onSearchChange()" *ngIf="searchKeyword">
                        清除搜索
                    </button>
                </div>

                <!-- 流程分组 -->
                <div class="group-section" *ngFor="let group of filteredFlowGroups">
                    <h3 class="group-title">
                        {{ group.title }}
                        <span class="group-count">({{ group.flows.length }})</span>
                    </h3>
                    <div class="flow-grid">
                        <ng-container *ngFor="let flow of group.flows">
                            <div class="flow-item" *ngIf="flow.enable"
                                 (click)="launchFlow(flow)"
                                 [ngClass]="{'flow-disabled': !flow.enable}">
                                <div class="flow-icon" [style]="{background:flow.color}">
                                    <span [classList]="flow.icon"></span>
                                </div>
                                <div class="flow-info">
                                    <div class="flow-name">{{ flow.name }}</div>
                                    <div class="flow-desc" *ngIf="flow.remark">{{ flow.remark }}</div>
                                </div>
                            </div>
                        </ng-container>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
