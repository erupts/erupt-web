<erupt-node
    [(model)]="modelValue"
    [readonly]="readonly"
    [headerColor]="color()"
    (select)="onSelect()"
    (insertNode)="onInsertNode($event)"
    (insertFlexNode)="onInsertFlexNode($event)"
    [eruptBuild]="eruptBuild"
    (saveProp)="onSaveProp()"
    [progress]="progress"
    (delete)="onDelete()">
    {{ name() }}
    <div config>
        <nz-segmented [nzOptions]="['设置审核人','表单权限','操作权限']" [(ngModel)]="selectTab" style="margin-bottom: 12px">

        </nz-segmented>
        <ng-container *ngIf="selectTab==0">
            <ng-container *ngFor="let reviewUserMode of approveNode.reviewUserModes; let i = index">
                <nz-card nzTitle="审批人" nzSize="small" style="margin-bottom: 12px">
                    <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                        <div style="flex: 1;">
                            <app-review-user
                                [reviewUserMode]="reviewUserMode">
                            </app-review-user>
                        </div>
                        <button
                            *ngIf="approveNode.reviewUserModes.length > 1"
                            nz-button
                            nzType="text"
                            nzDanger
                            nzSize="small"
                            (click)="deleteReviewUser(i)"
                            [nz-tooltip]="'删除审批人'"
                            style="margin-left: 8px;">
                            <span nz-icon nzType="delete" nzTheme="outline"></span>
                        </button>
                    </div>
                </nz-card>
            </ng-container>
            <button nz-button style="margin-bottom: 12px" (click)="addReviewUsers()">
                <span nz-icon nzType="plus" nzTheme="outline"></span>
                添加审批人
            </button>
            <nz-divider style="margin: 12px 0"></nz-divider>
            <div>
                <h4>多人审批时使用的审批方式</h4>
                <nz-radio-group [(ngModel)]="approveNode.approvalStrategy">
                    <label style="width: 100%" nz-radio [nzValue]="ApprovalStrategy.ANY_APPROVE">或签（一名审批人同意即可）</label>
                    <label style="width: 100%;margin-top: 8px" nz-radio [nzValue]="ApprovalStrategy.ALL_APPROVE">会签（需所有审批人同意）</label>
                </nz-radio-group>
            </div>
            <nz-divider style="margin: 12px 0"></nz-divider>
            <div>
                <h4>审批超时设置</h4>
                <nz-switch [(ngModel)]="approveNode.approvalTimeoutEnabled"></nz-switch>
                <div *ngIf="approveNode.approvalTimeoutEnabled" style="margin-top: 12px">
                    <nz-input-number [(ngModel)]="approveNode.approvalTimeoutHours" [nzMin]="1" [nzStep]="1" style="width: 120px"></nz-input-number>
                    <span style="margin: 0 8px"> 小时后 → </span>
                    <nz-radio-group [(ngModel)]="approveNode.approvalTimeoutAction">
                        <label nz-radio [nzValue]="ApprovalTimeoutAction.AUTO_PASS">自动同意</label>
                        <label nz-radio [nzValue]="ApprovalTimeoutAction.AUTO_REJECT">自动拒绝</label>
                    </nz-radio-group>
                </div>
            </div>
        </ng-container>
        <ng-container *ngIf="selectTab==1">
            <app-form-access [eruptBuild]="eruptBuild" [formAccesses]="approveNode.formAccesses"/>
        </ng-container>
        <ng-container *ngIf="selectTab==2">
            <div class="allow-item">
                <label nz-checkbox [(ngModel)]="approveNode.allowTransfer">允许转交</label>
            </div>
            <div class="allow-item">
                <label nz-checkbox [(ngModel)]="approveNode.allowAddSign">允许加签</label>
            </div>
            <div class="allow-item">
                <label nz-checkbox [(ngModel)]="approveNode.allowCc">允许抄送</label>
            </div>
            <div class="allow-item">
                <label nz-checkbox [(ngModel)]="approveNode.allowReturn">允许退回</label>
            </div>
            <div class="allow-item">
                <label nz-checkbox [(ngModel)]="approveNode.requireSignature">审批同意时需手写签名</label>
            </div>
            <div class="allow-item">
                <label nz-checkbox [(ngModel)]="approveNode.requireApprovalNote">提交审批需填写审批意见</label>
            </div>
        </ng-container>
    </div>
</erupt-node>
