<div class="upms-select-container">
    <!-- 左侧面板：选择 -->
    <div class="left-panel">
        <!-- 标签页 -->
        <div class="tabs">
            <div
                *ngFor="let tab of tabs; let i = index"
                class="tab-item"
                [class.active]="activeTab === i"
                (click)="onTabChange(i)"
            >
                <span nz-icon
                      [nzType]="tab.icon"
                      nzTheme="outline">
                </span>
                <span class="tab-label">{{ tab.label }}</span>
            </div>
        </div>

        <!-- 搜索框 -->
        <div class="search-container">
            <nz-input-group nzSize="default">
                <input
                    nz-input
                    [placeholder]="getSearchPlaceholder()"
                    [(ngModel)]="searchText"
                />
            </nz-input-group>
        </div>

        <!-- 项目列表 -->
        <div class="item-list">
            <div class="item-list-header">
                <span class="item-count">{{ getListTitle() }}</span>
                <span class="item-tip">点击选择或取消选择</span>
            </div>

            <div
                *ngFor="let item of filteredItems; trackBy: trackByItem"
                class="item-item"
                [class.selected]="item.checked"
                (click)="onItemToggle(item)"
            >
                <label
                    nz-checkbox
                    [ngModel]="item.checked"
                    (ngModelChange)="onItemToggle(item)"
                    (click)="$event.stopPropagation()"
                ></label>
                <span class="item-name">{{ item.name }}</span>

                <!-- 显示额外信息 -->
<!--                <div class="item-extra" *ngIf="item.type === 'user' && (item as User).department">-->
<!--                    <span class="department">{{ (item as User).department }}</span>-->
<!--                </div>-->
<!--                <div class="item-extra" *ngIf="item.type === 'position' && (item as Position).department">-->
<!--                    <span class="department">{{ (item as Position).department }}</span>-->
<!--                    <span class="level" *ngIf="(item as Position).level">{{ (item as Position).level }}</span>-->
<!--                </div>-->
<!--                <div class="item-extra" *ngIf="item.type === 'org' && (item as Organization).level">-->
<!--                    <span class="level">L{{ (item as Organization).level }}</span>-->
<!--                </div>-->
            </div>

            <div *ngIf="filteredItems.length === 0" class="empty-state">
                <span nz-icon nzType="search" nzTheme="outline"></span>
                <p>{{ getEmptyStateText() }}</p>
            </div>
        </div>
    </div>

    <!-- 右侧面板：已选项目 -->
    <div class="right-panel">
        <div class="selected-header">
            <div class="selected-info">
                <h3 class="selected-count">
                    <span nz-icon nzType="check-circle" nzColor="#52c41a"></span>
                    {{ getSelectedTitle() }}
                </h3>
            </div>
            <button
                nz-button
                nzType="link"
                nzSize="small"
                nzDanger
                (click)="onClearAll()"
                class="clear-btn"
                [disabled]="selectedCount === 0"
            >
                <span nz-icon nzType="delete" nzTheme="outline"></span>
                清空
            </button>
        </div>

        <div class="selected-items">
            <div
                *ngFor="let item of selectedItems; trackBy: trackByItem"
                class="selected-item-item"
            >
                <div class="item-info">
                    <span nz-icon
                          [nzType]="item.type === 'org' ? 'apartment' :
                                   item.type === 'role' ? 'safety-certificate' :
                                   item.type === 'user' ? 'user' : 'idcard'"
                          nzTheme="outline"
                          class="item-icon">
                    </span>
                    <span class="item-name">{{ item.name }}</span>

                    <!-- 显示额外信息 -->
<!--                    <div class="item-extra" *ngIf="item.type === 'user' && (item as User).department">-->
<!--                        <span class="department">{{ (item as User).department }}</span>-->
<!--                    </div>-->
<!--                    <div class="item-extra" *ngIf="item.type === 'position' && (item as Position).department">-->
<!--                        <span class="department">{{ (item as Position).department }}</span>-->
<!--                        <span class="level" *ngIf="(item as Position).level">{{ (item as Position).level }}</span>-->
<!--                    </div>-->
<!--                    <div class="item-extra" *ngIf="item.type === 'org' && (item as Organization).level">-->
<!--                        <span class="level">L{{ (item as Organization).level }}</span>-->
<!--                    </div>-->
                </div>
                <button
                    nz-button
                    nzType="text"
                    nzSize="small"
                    nzDanger
                    (click)="onItemRemove(item)"
                    class="remove-btn"
                    nz-tooltip
                    [nzTooltipTitle]="'移除' + currentTabLabel"
                >
                    <span nz-icon nzType="close" nzTheme="outline"></span>
                </button>
            </div>

            <div *ngIf="selectedCount === 0" class="empty-selected">
                <span nz-icon
                      [nzType]="currentTabKey === 'org' ? 'apartment' :
                               currentTabKey === 'role' ? 'safety-certificate' :
                               currentTabKey === 'user' ? 'user-add' : 'idcard'"
                      nzTheme="outline">
                </span>
                <p>{{ getEmptySelectedText() }}</p>
                <span class="empty-tip">{{ getEmptySelectedTip() }}</span>
            </div>
        </div>
    </div>
</div>
