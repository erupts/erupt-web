<div class="gantt-container">
    <ngx-gantt #gantt [items]="items || []" [groups]="groups" [showToolbar]="true"
               [viewType]="GanttViewType.day" [draggable]="eruptBuildModel.eruptModel.eruptJson.power.edit"
               [toolbarOptions]="{viewTypes:[GanttViewType.day, GanttViewType.week, GanttViewType.month,GanttViewType.quarter, GanttViewType.year]}"
               [ngStyle]="{height: (44 * 13) + 'px'}"
               [virtualScrollEnabled]="true"
               (dragEnded)="dragEnded($event)"
               (viewChange)="onViewChange()">
        <ngx-gantt-table>
            <ngx-gantt-column [width]="editColumnWidth" *ngIf="editColumnWidth">
                <ng-template #header>
                    <div style="text-align: center;width: 100%">
                        <label nz-checkbox
                               [nzChecked]="isAllSelected()"
                               [nzIndeterminate]="isIndeterminate()"
                               (nzCheckedChange)="toggleSelectAll($event)"
                               (click)="$event.stopPropagation()">
                        </label>
                    </div>
                </ng-template>
                <ng-template #cell let-item="item">
                    <div style="text-align: center" (click)="toggleSelection(item)">
                        <label nz-checkbox
                               [nzChecked]="isSelected(item)"
                               (nzCheckedChange)="toggleSelection(item)"
                               (click)="$event.stopPropagation()">
                        </label>
                    </div>
                </ng-template>
            </ngx-gantt-column>
            <ng-container *ngIf="vis.fields.length">
                <ng-container *ngFor="let field of vis.fields; let first = first">
                    <ngx-gantt-column [name]="getEruptField(field)?.edit?.title">
                        <ng-template #cell let-item="item">
                            <div (click)="columnMap.get(field)?.click(item?.origin)" style="cursor: pointer;">
                                <ng-container *ngIf="columnMap.get(field)?.format">
                                    <div style="text-align: center" [innerHTML]="(columnMap.get(field)?.format(item?.origin,columnMap.get(field),null)||'')|safeHtml"></div>
                                </ng-container>
                                <ng-container *ngIf="!columnMap.get(field)?.format">
                                    <div [innerHTML]="(item?.origin?.[field]==null?'':item?.origin?.[field])|safeHtml"></div>
                                </ng-container>
                            </div>
                        </ng-template>
                    </ngx-gantt-column>
                </ng-container>
            </ng-container>
            <ngx-gantt-column [width]="50" *ngIf="eruptBuildModel.eruptModel.eruptJson.power.edit">
                <ng-template #header>
                    <div style="text-align: center;width: 100%">
                        <i nz-icon nzType="edit" ></i>
                    </div>
                </ng-template>
                <ng-template #cell let-item="item">
                    <div (click)="edit(item)">
                        <i nz-icon nzType="edit" nzTheme="twotone" style="cursor: pointer"></i>
                    </div>
                </ng-template>
            </ngx-gantt-column>
            <ngx-gantt-column width="50px">
                <ng-template #header>
                    <div style="text-align: center;width: 100%">
                        <i nz-icon nzType="aim" nzTheme="outline"></i>
                    </div>
                </ng-template>
                <ng-template #cell let-item="item">
                    <div (click)="scrollToDate(item)" *ngIf="item.start || item.end" style="text-align: center">
                        <i nz-icon nzType="aim" nzTheme="outline" style="cursor: pointer;color: #09f"></i>
                    </div>
                </ng-template>
            </ngx-gantt-column>
        </ngx-gantt-table>
    </ngx-gantt>
    <button nz-button nzType="primary" nzShape="circle" nzSize="large"
            class="scroll-to-today-btn"
            (click)="scrollToToday()"
            nz-tooltip nzTooltipTitle="定位到今天">
        <i nz-icon nzType="calendar" nzTheme="outline"></i>
    </button>
</div>
